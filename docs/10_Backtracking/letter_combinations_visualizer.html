<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Letter Combinations é›»è©±è™Ÿç¢¼çµ„åˆ - è¦–è¦ºåŒ–</title>
    <link rel="stylesheet" href="../assets/visualizer/style.css">
    <style>
        .phone { display: flex; gap: 10px; justify-content: center; margin: 20px 0; }
        .digit { width: 60px; padding: 10px; text-align: center; border-radius: 8px; background: var(--viz-primary); color: white; }
        .digit .num { font-size: 1.5rem; font-weight: bold; }
        .digit .letters { font-size: 0.9rem; opacity: 0.8; }
        .digit.current { background: var(--viz-secondary); color: #0f172a; }
        .combinations { display: flex; gap: 6px; justify-content: center; flex-wrap: wrap; margin: 15px 0; padding: 15px; background: var(--viz-bg-secondary); border-radius: 8px; min-height: 50px; }
        .combo { background: var(--viz-success); color: #0f172a; padding: 6px 12px; border-radius: 6px; font-weight: bold; font-family: monospace; }
        .combo.new { animation: popIn 0.3s; }
        @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }
    </style>
</head>
<body>
    <div class="main-layout">
        <div class="canvas-area">
            <div class="viz-card">
                <div class="viz-title">é›»è©±è™Ÿç¢¼å­—æ¯çµ„åˆï¼ˆBACKTRACKINGï¼‰</div>
                <div class="phone" id="phoneDisplay"></div>
                <div style="text-align: center; color: var(--text-muted);">æ‰€æœ‰çµ„åˆ</div>
                <div class="combinations" id="combosDisplay"></div>
                <div class="controls" style="margin-top: 15px;">
                    <button class="viz-btn" id="prevBtn">â† ä¸Šä¸€æ­¥</button>
                    <div class="step-indicator">æ­¥é©Ÿ <span id="currentStep">0</span> / <span id="totalSteps">0</span></div>
                    <button class="viz-btn primary" id="nextBtn">ä¸‹ä¸€æ­¥ â†’</button>
                    <button class="viz-btn" onclick="resetVisualization()">â†» é‡ç½®</button>
                    <button class="viz-btn play-btn" id="playBtn" onclick="viz.toggleAutoPlay()">â–¶ è‡ªå‹•æ’­æ”¾</button>
                    <div class="speed-control">
                        <label>é€Ÿåº¦:</label>
                        <select id="speedSelect" onchange="viz.setSpeed(Number(this.value))">
                            <option value="2000">0.5x</option>
                            <option value="1500" selected>1x</option>
                            <option value="1000">1.5x</option>
                            <option value="500">2x</option>
                        </select>
                    </div>
                </div>
                <div class="state-grid">
                    <div class="state-item"><div class="state-label">çµ„åˆæ•¸</div><div class="state-value" id="countDisplay" style="color: var(--viz-success);">0</div></div>
                </div>
            </div>
            <div class="viz-card"><div class="viz-title">æ¼”ç®—æ³•èªªæ˜</div><div class="explanation" id="explanation"></div></div>
        </div>
        <div class="code-area">
            <div class="viz-card" style="height: 100%;">
                <div class="viz-title">æ¼”ç®—æ³• (C++)</div>
                <div class="code-panel" id="codeDisplay"></div>
            </div>
        </div>
    </div>
    <script src="../assets/visualizer/core.js"></script>
    <script>
        const codeStructure = [
            { line: 'vector<string> letterCombinations(string digits) {', id: 0 },
            { line: '    if (digits.empty()) return {};', id: 1 },
            { line: '    map<char, string> phone = {', id: 2 },
            { line: '        {\'2\',"abc"},{\'3\',"def"},{\'4\',"ghi"},', id: 3 },
            { line: '        {\'5\',"jkl"},{\'6\',"mno"},{\'7\',"pqrs"},', id: 4 },
            { line: '        {\'8\',"tuv"},{\'9\',"wxyz"}};', id: 5 },
            { line: '    vector<string> result;', id: 6 },
            { line: '    backtrack(digits, 0, "", result, phone);', id: 7 },
            { line: '    return result;', id: 8 },
            { line: '}', id: 9 },
            { line: 'void backtrack(string& digits, int i, string cur,', id: 10 },
            { line: '               vector<string>& result, map<...>& phone) {', id: 11 },
            { line: '    if (i == digits.size()) { result.push_back(cur); return; }', id: 12 },
            { line: '    for (char c : phone[digits[i]])', id: 13 },
            { line: '        backtrack(digits, i+1, cur+c, result, phone);', id: 14 },
            { line: '}', id: 15 },
        ];
        const digits = "23";
        const mapping = {'2': 'abc', '3': 'def'};
        function generateAlgorithmSteps() {
            const steps = [];
            steps.push({ currentDigit: -1, combos: [], highlightLines: [0,1,2,3,4,5,6,7], explanation: { title: 'åˆå§‹åŒ–', text: 'digits = "23"<br>2 â†’ abc<br>3 â†’ def<br><br>çµ„åˆæ•¸ = 3 Ã— 3 = 9' } });
            const allCombos = ['ad','ae','af','bd','be','bf','cd','ce','cf'];
            for (let i = 0; i < allCombos.length; i++) {
                const d = Math.floor(i / 3);
                steps.push({ currentDigit: 1, combos: allCombos.slice(0, i+1), newIdx: i, highlightLines: [12,13,14], explanation: { title: `çµ„åˆ: ${allCombos[i]}`, text: `${allCombos[i][0]} (from 2) + ${allCombos[i][1]} (from 3)` } });
            }
            steps.push({ currentDigit: -1, combos: allCombos, final: true, highlightLines: [8], explanation: { title: 'ğŸ‰ å®Œæˆï¼', text: `å…± 9 ç¨®çµ„åˆ<br><br>æ™‚é–“ï¼šO(4^n Ã— n)` } });
            return steps;
        }
        let viz;
        function init() {
            viz = new AlgorithmVisualizer({
                codeLines: codeStructure,
                onStepChange: (step) => {
                    const phoneData = [['2','abc'],['3','def']];
                    document.getElementById('phoneDisplay').innerHTML = phoneData.map((p, i) => `<div class="digit${i === step.currentDigit ? ' current' : ''}"><div class="num">${p[0]}</div><div class="letters">${p[1]}</div></div>`).join('');
                    document.getElementById('combosDisplay').innerHTML = (step.combos || []).map((c, i) => `<span class="combo${i === step.newIdx ? ' new' : ''}">${c}</span>`).join('') || 'ç­‰å¾…...';
                    document.getElementById('countDisplay').textContent = step.combos?.length ?? 0;
                }
            });
            viz.setSteps(generateAlgorithmSteps());
        }
        function resetVisualization() { init(); }
        window.addEventListener('load', init);
    </script>
</body>
</html>
