# 3Sum (ä¸‰æ•¸ä¹‹å’Œ) <span style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.85em; font-weight: 600; margin-left: 10px; display: inline-flex; align-items: center; gap: 4px; box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);">ğŸŸ¡ Medium</span>

> ğŸ“Œ **LeetCode #15** â€” [é¡Œç›®é€£çµ](https://leetcode.com/problems/3sum/) | [NeetCode è§£èªª](https://neetcode.io/problems/3sum)


## 1. ğŸ§ Problem Dissection (é‡æ¸…å•é¡Œ)

é¡Œç›®çµ¦æˆ‘å€‘ä¸€å€‹æ•´æ•¸é™£åˆ— `nums`ï¼Œè¦æ±‚æ‰¾å‡ºæ‰€æœ‰ **Unique Triplets** `[nums[i], nums[j], nums[k]]` ä½¿å¾—ï¼š

1.  `i != j`, `i != k`, `j != k` (ä¸åŒå…ƒç´ )
2.  `nums[i] + nums[j] + nums[k] == 0` (ç¸½å’Œç‚º 0)

å›å‚³é€™äº› tripletsã€‚æ³¨æ„ï¼š**Output ä¸å¯ä»¥åŒ…å«é‡è¤‡çš„ triplets**ã€‚

- **Input**: `[-1,0,1,2,-1,-4]`
- **Output**: `[[-1,-1,2], [-1,0,1]]`
- **Constraints**:
  - $3 <= nums.length <= 3000$
  - Space: æœ€å¥½æ˜¯ $O(1)$ or $O(n)$ (ä¸å« output)ã€‚

- **Clarification**:
  - "Unique triplets" æ˜¯æœ€æ£˜æ‰‹çš„éƒ¨åˆ†ã€‚ä¾‹å¦‚ `[-1, 0, 1]` å’Œ `[0, 1, -1]` è¦–ç‚ºåŒä¸€å€‹ã€‚

---

## 2. ğŸ¢ Brute Force Approach (æš´åŠ›è§£)

ä¸‰å±¤è¿´åœˆï¼š

```cpp
for i ...
  for j ...
    for k ...
      if nums[i] + nums[j] + nums[k] == 0 -> add to set (for dedup)
```

- **Time**: $O(n^3)$ã€‚å°æ–¼ $n=3000$ï¼Œ $n^3 \approx 2.7 \times 10^{10}$ï¼Œçµ•å° TLEã€‚

---

## 3. ğŸ’¡ The "Aha!" Moment (å„ªåŒ–)

é€™é¡Œå…¶å¯¦æ˜¯ **Two Sum II** çš„å»¶ä¼¸ã€‚

å¦‚æœæˆ‘ä»¬å…ˆ**å›ºå®šä¸€å€‹æ•¸å­—** `nums[i]`ï¼Œé‚£éº¼å•é¡Œå°±è®Šæˆäº†ï¼š
åœ¨ `nums[i+1...end]` ä¸­æ‰¾å‡ºå…©å€‹æ•¸å­—ï¼Œä½¿å¾—å®ƒå€‘çš„å’Œç­‰æ–¼ `-nums[i]`ã€‚
-> é€™å°±æ˜¯ **Two Sum**ï¼

ç‚ºäº†æœ‰æ•ˆåˆ©ç”¨ Two Sum II (Sorted Array + Two Pointers) çš„é«˜æ•ˆèƒ½ï¼Œä¸¦è§£æ±ºæœ€éº»ç…©çš„ã€Œå»é‡ (De-duplication)ã€å•é¡Œï¼Œæˆ‘å€‘å¯ä»¥ï¼š

1.  **Sort the Array**: è®“æ‰€æœ‰æ•¸å­—ç”±å°åˆ°å¤§æ’åˆ—ã€‚
    - é€™å°å»é‡è‡³é—œé‡è¦ï¼šç›¸åŒçš„æ•¸å­—æœƒèšåœ¨ä¸€èµ·ã€‚
2.  **Iterate `i`**: é€™æ˜¯æˆ‘å€‘å›ºå®šçš„ç¬¬ä¸€å€‹æ•¸å­—ã€‚
    - å¦‚æœ `nums[i] > 0`ï¼Œå› ç‚ºå·²æ’åºï¼Œå¾Œé¢çš„æ•¸å­—è‚¯å®šæ›´å¤§ï¼Œç¸½å’Œä¸å¯èƒ½å›é ­è®Šæˆ 0ï¼Œç›´æ¥ breakã€‚
    - **å»é‡ (Skip Duplicates)**: å¦‚æœ `nums[i] == nums[i-1]`ï¼Œè·³éï¼é€™èƒ½é¿å…ç”¢ç”Ÿé‡è¤‡çš„ç¬¬ä¸€å€‹æ•¸å­—ã€‚
3.  **Two Pointers (`left`, `right`)**: å°‹æ‰¾å‰©ä¸‹çš„å…©å€‹æ•¸å­—ã€‚
    - `target = -nums[i]`
    - `sum = nums[left] + nums[right]`
    - å¦‚æœ `sum > target` -> `right--`
    - å¦‚æœ `sum < target` -> `left++`
    - å¦‚æœ `sum == target`:
      - ç´€éŒ„ç­”æ¡ˆã€‚
      - `left++`, `right--`ã€‚
      - **Inner Loop å»é‡**: Move `left` å¾Œï¼Œå¦‚æœ `nums[left] == nums[left-1]`ï¼Œç¹¼çºŒ `left++`ï¼Œç›´åˆ°æ‰¾åˆ°æ–°æ•¸å­—ã€‚é€™èƒ½é¿å…ç”¢ç”Ÿé‡è¤‡çš„ç¬¬äºŒã€ä¸‰å€‹æ•¸å­—ã€‚

### ğŸ¬ Visualization (æ¼”ç®—æ³•è¦–è¦ºåŒ–)

<div style="position: relative; padding-bottom: 50%; height: 0; overflow: hidden; max-width: 100%; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.5); background: #0f172a;">
    <iframe src="../three_sum_visualizer.html" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;" loading="lazy"></iframe>
</div>
<p style="text-align: right; margin-top: 8px;"><a href="../three_sum_visualizer.html" target="_blank" style="font-size: 0.9em; display: inline-flex; align-items: center; gap: 4px; color: #818cf8; text-decoration: none;"><span>â¤¢</span> å…¨è¢å¹•é–‹å•Ÿè¦–è¦ºåŒ–</a></p>

---

## 4. ğŸ’» Implementation (ç¨‹å¼ç¢¼)

### Approach: Sorting + Two Pointers

```cpp
#include <vector>
#include <algorithm>

using namespace std;

class Solution {
public:
    vector<vector<int>> threeSum(vector<int>& nums) {
        // 1. Sort the array
        sort(nums.begin(), nums.end());
        vector<vector<int>> res;

        for (int i = 0; i < nums.size(); i++) {
            // Optimization: if current number is positive, we can't make 0 sum with subsequent numbers
            if (nums[i] > 0) break;

            // Skip duplicate for the first number
            if (i > 0 && nums[i] == nums[i - 1]) continue;

            int left = i + 1;
            int right = nums.size() - 1;

            while (left < right) {
                int sum = nums[i] + nums[left] + nums[right];

                if (sum > 0) {
                    right--;
                } else if (sum < 0) {
                    left++;
                } else {
                    res.push_back({nums[i], nums[left], nums[right]});
                    left++;
                    right--;

                    // Skip duplicate for the second number
                    // æ³¨æ„ï¼šåªéœ€è² è²¬ä¸€é‚Šï¼Œå¦ä¸€é‚Šæœƒå› ç‚º sum ä¸å¹³è¡¡è€Œè‡ªç„¶ç§»å‹•
                    while (left < right && nums[left] == nums[left - 1]) {
                        left++;
                    }
                }
            }
        }
        return res;
    }
};
```

### Python Reference

```python
class Solution:
    def threeSum(self, nums: List[int]) -> List[List[int]]:
        res = []
        nums.sort()

        for i, a in enumerate(nums):
            if a > 0:
                break

            if i > 0 and a == nums[i - 1]:
                continue

            l, r = i + 1, len(nums) - 1
            while l < r:
                threeSum = a + nums[l] + nums[r]
                if threeSum > 0:
                    r -= 1
                elif threeSum < 0:
                    l += 1
                else:
                    res.append([a, nums[l], nums[r]])
                    l += 1
                    r -= 1
                    while l < r and nums[l] == nums[l - 1]:
                        l += 1
        return res
```

---

## 5. ğŸ“ Detailed Code Comments (è©³ç´°è¨»è§£)

```cpp
class Solution {
public:
    vector<vector<int>> threeSum(vector<int>& nums) {
        vector<vector<int>> result;
        // Step 1: æ’åº (é—œéµ)
        // ç‚ºäº†ä½¿ç”¨ Two Pointers ä¸¦æ–¹ä¾¿å»é‡
        sort(nums.begin(), nums.end());

        for (int i = 0; i < nums.size(); i++) {
            // å‰ªæå„ªåŒ–ï¼š
            // å¦‚æœ nums[i] å·²ç¶“ > 0ï¼Œå› ç‚ºé™£åˆ—å·²æ’åºï¼Œå¾Œé¢ä¸å¯èƒ½æœ‰è² æ•¸ä¾†æŠµéŠ·å®ƒ
            if (nums[i] > 0) break;

            // å»é‡ (é‡å°ç¬¬ä¸€å€‹æ•¸å­— a)
            // i > 0 ç¢ºä¿ä¸æª¢æŸ¥ nums[-1]
            if (i > 0 && nums[i] == nums[i-1]) continue;

            int low = i + 1;
            int high = nums.size() - 1;

            while (low < high) {
                int sum = nums[i] + nums[low] + nums[high];

                if (sum > 0) {
                    high--;
                } else if (sum < 0) {
                    low++;
                } else {
                    // æ‰¾åˆ°ä¸€çµ„è§£
                    result.push_back({nums[i], nums[low], nums[high]});

                    // æ‰¾åˆ°äº†è§£ä¹‹å¾Œï¼Œè¦ç¹¼çºŒç¸®å°ç¯„åœæ‰¾ä¸‹ä¸€çµ„
                    low++;
                    high--;

                    // å»é‡ (é‡å°ç¬¬äºŒå€‹æ•¸å­— b)
                    // å› ç‚º c (ç¬¬ä¸‰å€‹æ•¸å­—) æœƒè¢« sum ç´„æŸï¼Œæ‰€ä»¥åªéœ€å° b å»é‡å³å¯
                    while (low < high && nums[low] == nums[low-1]) {
                        low++;
                    }
                }
            }
        }

        return result;
    }
};
```

---

## 6. ğŸ“Š Rigorous Complexity Analysis (è¤‡é›œåº¦åˆ†æ)

- **Time Complexity**: $O(n^2)$
  - Sorting: $O(n \log n)$ã€‚
  - Loops: å¤–å±¤è¿´åœˆè·‘ $n$ æ¬¡ï¼Œå…§å±¤ Two Pointers è·‘ $O(n)$ æ¬¡ -> ç¸½å…± $O(n^2)$ã€‚
  - ç¸½åˆ: $O(n^2)$ã€‚é€™æ˜¯æ¯” Brute Force $O(n^3)$ å·¨å¤§çš„é€²æ­¥ã€‚
- **Space Complexity**: $O(1)$ or $O(n)$
  - å–æ±ºæ–¼ Sorting æ¼”ç®—æ³•çš„å¯¦ä½œç´°ç¯€ (C++ `std::sort` æ··åˆä½¿ç”¨ QuickSort/HeapSort/InsertionSortï¼Œé€šå¸¸è¦–ç‚º $O(\log n)$ stack space)ã€‚
  - æˆ‘å€‘æ²’æœ‰ä½¿ç”¨é¡å¤–çš„ Hash Mapã€‚

**ç‚ºä»€éº¼ä¸ç”¨ Hash Map (Like Two Sum I)?**
å¦‚æœæˆ‘å€‘æ”¹ç”¨ Hash Mapï¼š

- å›ºå®š `i`ï¼Œç„¶å¾Œç”¨ Map è§£ Two Sumã€‚
- å„ªé»ï¼šä¹Ÿå¯ä»¥åšã€‚
- ç¼ºé»ï¼š**å»é‡ (Dedup) æœƒéå¸¸éå¸¸ç—›è‹¦**ã€‚ä½ éœ€è¦åœ¨ Output åŠ å…¥å‰æª¢æŸ¥æ˜¯å¦å·²å­˜åœ¨ï¼Œæˆ–è€…ç”¨ `set<vector<int>>` ä¾†æ¥çµæœç„¶å¾Œå†è½‰ vectorï¼Œé€™æœƒå¢åŠ å·¨å¤§çš„å¸¸æ•¸é–‹éŠ·ã€‚
- åœ¨ 3Sum ä¸­ï¼Œ**Sorted + Two Pointers** å¹¾ä¹ç¸½æ˜¯å„ªæ–¼ Hash Mapã€‚

---

## 7. ğŸ’¼ Interview Tips (é¢è©¦æŠ€å·§) â­ é«˜é »é¡Œ

### ğŸ¯ Follow-up å•é¡Œ

é¢è©¦å®˜å¯èƒ½æœƒå•çš„å»¶ä¼¸å•é¡Œï¼š

- 3Sum Closest? 4Sum?
- å¦‚ä½•è™•ç†é‡è¤‡è§£ï¼Ÿ

### ğŸš© å¸¸è¦‹éŒ¯èª¤ (Red Flags)

é¿å…é€™äº›æœƒè®“é¢è©¦å®˜æ‰£åˆ†çš„éŒ¯èª¤ï¼š

- âš ï¸ æ²’æœ‰å»é‡å°è‡´é‡è¤‡è§£
- âš ï¸ æ’åºå¾Œå¿˜è¨˜è§£çš„ indices å·²æ”¹è®Š

### âœ¨ åŠ åˆ†é … (Bonus Points)

é€™äº›æœƒè®“ä½ è„«ç©è€Œå‡ºï¼š

- ğŸ’ æ¸…æ™°çš„å»é‡é‚è¼¯
- ğŸ’ æ™‚é–“è¤‡é›œåº¦åˆ†æï¼šO(nÂ²)

---

## ğŸ“š Related Problems (ç›¸é—œé¡Œç›®)

### ç«™å…§ç›¸é—œ
- [Two Sum II - Input Array Is Sorted (å…©æ•¸ä¹‹å’Œ II - è¼¸å…¥å·²æ’åº)](02_Two_Sum_II.md)
- [Container With Most Water (ç››æœ€å¤šæ°´çš„å®¹å™¨)](04_Container_With_Most_Water.md)

### é€²éšæŒ‘æˆ°
- [3Sum Closest](https://leetcode.com/problems/3sum-closest/) â€” LeetCode
- [4Sum](https://leetcode.com/problems/4sum/) â€” LeetCode
